<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Frameset//EN" "http://www.w3.org/TR/html4/frameset.dtd">
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1"></meta>
</head>
<body id="body_home" align="center">
ChatBot TEST Callback Test
<script type='text/javascript' src='https://aceaidrico--svimvp3.sandbox.my.site.com/ESWEnhancedChatBot1706709397585/assets/js/bootstrap.min.js'></script>
<script type='text/javascript'>
    function initEmbeddedMessaging() {
        try {
            embeddedservice_bootstrap.settings.language = 'it'; // For example, enter 'en' or 'en-US'

            window.addEventListener("onEmbeddedMessagingReady", () => {
                    embeddedservice_bootstrap.prechatAPI.setHiddenPrechatFields({'APISITOWEB' : 'AAT2'});
                }
            );

            embeddedservice_bootstrap.init(
                '00D1q0000008iac',
                'Enhanced_ChatBot',
                'https://aceaidrico--svimvp3.sandbox.my.site.com/ESWEnhancedChatBot1706709397585',
                {
                    scrt2URL: 'https://aceaidrico--svimvp3.sandbox.my.salesforce-scrt.com'
                }
            );
        } catch (err) {
            console.error('Error loading Embedded Messaging: ', err);
        }
    };

window.addEventListener('message', function(event) {
    console.log("Event ", JSON.stringify(event));
});

    function onLoadIframe() {
        var iframe = document.querySelector('.embeddedMessagingSiteContextFrame');
        console.log("iframe2 " + iframe);
	    iframe.setAttribute('allow-scripts', '');
        iframe.setAttribute('allow-same-origin', '');
        iframe.setAttribute('allow-forms', '');
    }

    if (!window.embeddedservice_bootstrap) {
        var s = document.createElement('script');
        s.setAttribute('src', 'https://aceaidrico--svimvp3.sandbox.my.site.com/ESWEnhancedChatBot1706709397585/assets/js/bootstrap.min.js');
        s.onload = function () {
            initEmbeddedMessaging(null);
        };
        document.body.appendChild(s);
    }

    // Aggiungi event listener per gestire il caricamento dell'iframe
    window.addEventListener('load', function() {
        var iframe = document.querySelector('.embeddedMessagingSiteContextFrame'); 
	    console.log("iframe " + iframe);
        iframe.addEventListener('load', onLoadIframe);
    });
</script>
	</body>
</html>
